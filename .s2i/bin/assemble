#!/bin/sh

echo ">>>>>>> Running custom assemble <<<<<<"

set -e

source "${JBOSS_CONTAINER_UTIL_LOGGING_MODULE}/logging.sh"
source "${JBOSS_CONTAINER_MAVEN_S2I_MODULE}/maven-s2i"

# include our overrides/extensions
source "${JBOSS_CONTAINER_EAP_S2I_MODULE}/s2i-core-hooks"

# invoke the build
maven_s2i_build

echo ">>>>>>> Installing Keycloak client adapter <<<<<<"
echo "Running from: $(pwd)"
echo "JBOSS_HOME=${JBOSS_HOME}"
ls ${JBOSS_HOME}/extensions
${JBOSS_HOME}/bin/jboss-cli.sh --file="${JBOSS_HOME}/extensions/adapter-elytron-install-offline.cli"